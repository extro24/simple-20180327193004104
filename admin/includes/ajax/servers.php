<?phpif ($act=='list_servers'){				// Get Servers	$servers=$db->getRows("select * from server order by id");	foreach ($servers as $key=>$server){		$online=$db->getFunction("select count(*) from tables where server_id='".$server->id."' and used_seats>1");		$offline=$db->getFunction("select count(*) from tables where server_id='".$server->id."' and used_seats<=1");		$servers[$key]->online=$online;		$servers[$key]->offline=$offline;		if ($server->port==0){$server->port=11211;}		$server->up=checkServerUp($server);	}//	$smarty->assign('servers',$servers);	$content=$smarty->fetch('bits/servers_tableservers.tpl');		$data["data"]=$content;	$data["object"]='tables_servers_content';	$data["command"]='set_object_html';	$ajax->add($data);										unset($data); // clear data		$data["data"]="refTimer=setTimeout('refresh_servers()',1000);";	$data["command"]='exec';	$ajax->add($data);										unset($data); // clear data}if ($act=='add_server'){	$title=cp('title');	$ip=cp('ip');	$port=cp('port');		if ($port=='' || $title=='' || $port==''){		$data["msg"]='Please fill all data';		$ajax->add($data);											unset($data); // clear data	}else{		$sc=$db->getFunction("select count(*) from server where title='$title'");		if ($sc>0){			$data["msg"]='A server with this title already exist';			$ajax->add($data);												unset($data); // clear data		}else{			$sc=$db->getFunction("select count(*) from server where ip='$ip'");			if ($sc>0){				$data["msg"]='This server address already set';				$ajax->add($data);													unset($data); // clear data			}else{				//check if server is up				$newServer->ip=$ip;				$newServer->port=$port;				$server_up=checkServerUp($newServer);				if (!$server_up){					$data["msg"]='Could not connect to server';					$ajax->add($data);														unset($data); // clear data				}else{					$db->query("insert into server set ip='$ip' , port='$port' , title='$title'");					$data["data"]="getObj('msg_window').style.display='none';";					$data["command"]='exec';					$ajax->add($data);														unset($data); // clear data				}			}		}	}		$data["data"]="";	$data["object"]='add_server_feedback';	$data["command"]='set_object_html';	$ajax->add($data);										unset($data); // clear data	}//if ($act=='lock_for_edit'){	$id=cp('id');		include 'includes/modules/table/table.php';	include 'includes/modules/player/player.php';		$tables=$db->getRows("select id from tables where server_id='$id'");	foreach ($tables as $dbTable){		$table=new table($dbTable->id);		$table->kickPlayers();		$table->available='0';		$table->saveTable();	}		$server=new Server($id);	$smarty->assign('server',$server);		$data["data"]=$smarty->fetch('bits/servers_edit_server.tpl');	$data["object"]=$act.'_feedback';	$data["command"]='set_object_html';	$ajax->add($data);										unset($data); // clear data	}//if ($act=='save_title'){	$title=cp('title');	$id=cp('id');		$server=new Server($id);	$server->title=$title;	$server->save();		$data["msg"]='New title saved !';	$ajax->add($data);										unset($data); // clear data		$data["data"]='Save';	$data["object"]=$act.'_feedback';	$data["command"]='set_object_html';	$ajax->add($data);										unset($data); // clear data	}//if ($act=='save_server'){	$ip=cp('ip');	$port=cp('port');	$id=cp('id');		$server=new Server($id);	$server->ip=$ip;	$server->port=$port;	if ($server->save()){		$data["msg"]='Saved !';	}else{		$data["msg"]=$server->error;	}	$ajax->add($data);										unset($data); // clear data		$data["data"]='Save';	$data["object"]=$act.'_feedback';	$data["command"]='set_object_html';	$ajax->add($data);										unset($data); // clear data	}//?>